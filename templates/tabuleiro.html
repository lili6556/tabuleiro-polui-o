<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Tabuleiro - Jogo de Tabuleiro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
  <style>
    .tabuleiro-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      text-align: center;
    }

    #imagemTabuleiro {
      width: 100%;
      max-width: 700px;
      height: auto;
      display: block;
      border-radius: 10px;
    }

    .personagem {
      position: absolute;
      width: 80px;
      touch-action: none;
      user-select: none;
      cursor: grab;
    }

    .personagem:active {
      cursor: grabbing;
    }

    .tabuleiro-botoes {
      margin-top: 30px;
    }

    button {
      background-color: #00bcd4;
      padding: 12px 25px;
      color: white;
      border: none;
      border-radius: 30px;
      font-size: 1.1em;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      font-family: 'Arial', cursive;
    }

    button:hover {
      background-color: #0097a7;
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <div class="tabuleiro-container">
    <h2>üìñ Tabuleiro</h2>
    <h2>(Clique e arraste para mexer nos personagens)</h2>
    <div style="position: relative; display: inline-block;">
      <img src="{{ url_for('static', filename='tabuleiro.jpg') }}" id="imagemTabuleiro">
      <img src="{{ url_for('static', filename='menino.png') }}" class="personagem" id="p1">
      <img src="{{ url_for('static', filename='menina.png') }}" class="personagem" id="p2">
    </div>

    <div class="tabuleiro-botoes">
      <a href="{{ url_for('perguntas') }}"><button>‚ùì Voltar para as Perguntas</button></a>
    </div>
  </div>

  <script>
    const personagem1 = document.getElementById("p1");
    const personagem2 = document.getElementById("p2");

    const posicoesSalvas = JSON.parse(localStorage.getItem("posicoesJogadores")) || {
      jogador1: { x: 65, y: 18 },
      jogador2: { x: 95, y: 18 }
    };

    personagem1.style.left = posicoesSalvas.jogador1.x + "px";
    personagem1.style.top = posicoesSalvas.jogador1.y + "px";

    personagem2.style.left = posicoesSalvas.jogador2.x + "px";
    personagem2.style.top = posicoesSalvas.jogador2.y + "px";

    function salvarPosicao(id, x, y) {
      const chave = id === "p1" ? "jogador1" : "jogador2";
      posicoesSalvas[chave] = { x, y };
      localStorage.setItem("posicoesJogadores", JSON.stringify(posicoesSalvas));
    }

    function ativarArrasteLivre(personagem) {
      let offsetX = 0, offsetY = 0, movendo = false;

      personagem.addEventListener("mousedown", (e) => {
        movendo = true;
        offsetX = e.clientX - personagem.offsetLeft;
        offsetY = e.clientY - personagem.offsetTop;
      });

      personagem.addEventListener("touchstart", (e) => {
        movendo = true;
        const touch = e.touches[0];
        offsetX = touch.clientX - personagem.offsetLeft;
        offsetY = touch.clientY - personagem.offsetTop;
      });

      document.addEventListener("mousemove", (e) => {
        if (!movendo) return;
        const x = e.clientX - offsetX;
        const y = e.clientY - offsetY;
        personagem.style.left = x + "px";
        personagem.style.top = y + "px";
      });

      document.addEventListener("touchmove", (e) => {
        if (!movendo) return;
        const touch = e.touches[0];
        const x = touch.clientX - offsetX;
        const y = touch.clientY - offsetY;
        personagem.style.left = x + "px";
        personagem.style.top = y + "px";
      });

      document.addEventListener("mouseup", () => {
        if (movendo) {
          salvarPosicao(personagem.id, personagem.offsetLeft, personagem.offsetTop);
        }
        movendo = false;
      });

      document.addEventListener("touchend", () => {
        if (movendo) {
          salvarPosicao(personagem.id, personagem.offsetLeft, personagem.offsetTop);
        }
        movendo = false;
      });
    }

    ativarArrasteLivre(personagem1);
    ativarArrasteLivre(personagem2);
  </script>
      <!-- Bolhas decorativas -->
    <div class="bolhas">
      <span></span><span></span><span></span><span></span>
      <span></span><span></span>
    </div>
</body>
</html>
